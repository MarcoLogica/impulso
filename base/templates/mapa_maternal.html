<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mapa Mental de Maternidad ‚Äì IMPULSO</title>
<style>

  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to right, #f6f9fc, #eaf4ff);
    margin: 0;
    padding: 40px;
    color: #34495e;
  }

  h1 {
    text-align: center;
    font-size: 80px;
    margin-bottom: 10px;
  }

  .subtitulo {
    font-size: 45px;
    text-align: center;
    font-style: italic;
    color: #7f8c8d;
    margin-bottom: 40px;
  }

  /* GRID PRINCIPAL */
  .grid-dimensiones {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
  }

  /* TARJETA DE DIMENSI√ìN */
  .dimension {
    font-size: 35px;
    background: #ffffff;
    padding: 22px;
    border-radius: 14px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    border-left: 8px solid #85c1e9;
    transition: transform 0.2s ease;
  }

  .dimension:hover {
    transform: translateY(-4px);
  }

  .dimension h2 {
    margin: 0;
    font-size: 55px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .barra-carga {
    margin-top: 12px;
    background: #e0e7ef;
    height: 14px;
    border-radius: 8px;
    overflow: hidden;
  }

  .barra-interna {
    height: 100%;
    background: linear-gradient(90deg, #6dd5fa, #2980b9);
    width: 40%; /* valor de ejemplo */
    transition: width 0.4s ease;
  }

  .porcentaje {
    margin-top: 6px;
    font-weight: bold;
    color: #2c3e50;
  }

  /* SUBCATEGOR√çAS */
  .subcategorias {
    margin-top: 18px;
    padding-left: 0;
    list-style: none;
  }

  .subcategorias li {
    background: #f8fbff;
    padding: 10px 14px;
    border-radius: 8px;
    margin-bottom: 8px;
    border-left: 5px solid #d6eaf8;
    font-size: 0.95em;
  }

  .subcategorias li strong {
    color: #2c3e50;
  }

  /* RESPONSIVE */
  @media (max-width: 600px) {
    h1 { font-size: 26px; }
    .dimension h2 { font-size: 20px; }
  }

  .iniciativa, .fase {
  font-size: 1.7rem;
  padding: 10px;
  background: #f7f7f7;
  border-radius: 6px;
  margin-top: 8px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
}

.iniciativa:hover, .fase:hover {
  background: #ececec;
}

.oculto {
  display: none;
}

.fases, .tareas {
  margin-left: 20px;
  margin-top: 6px;
  font-size: 1.2rem;
}

.tarea {
font-size: 1.5rem;
  padding: 4px 0;
}

  .tarea {
  font-size: 1.5rem;
  padding: 4px 6px;
  border-radius: 4px;
  margin-bottom: 4px;
  display: inline-block;
}

/* Estado: Pendiente */
.tarea-pendiente {
  background-color: #fff3cd;
  color: #856404;
}

/* Estado: En progreso */
.tarea-progreso {
  background-color: #cce5ff;
  color: #004085;
}

/* Estado: Completada */
.tarea-completada {
  background-color: #d4edda;
  color: #155724;
  text-decoration: line-through;
}



  /* PRIORIDAD M√ÅXIMA: si es retrasada, SIEMPRE se ve roja */
.tarea-retrasada {
  background-color: #f8d7da !important;
  color: #721c24 !important;
  font-weight: bold;
  border-left: 4px solid #721c24;
}

  /* Layout general del grid */
.grid-dimensiones {
  display: grid;
  grid-template-columns: repeat(1, 1fr);
  gap: 15px;
}

/* M√≥viles: 2 tarjetas por fila */
@media (max-width: 600px) {
  .grid-dimensiones {
    grid-template-columns: repeat(1, 1fr);
  }
}

/* M√≥viles muy peque√±os: 1 tarjeta por fila */
@media (max-width: 380px) {
  .grid-dimensiones {
    grid-template-columns: 1fr;
  }
}

  /* Tama√±os generales m√°s grandes */
.iniciativa strong {
  font-size: 2.5rem;
}

.fase strong {
  font-size: 2rem;
}

.tarea {
  font-size: 1.5rem;
}

/* Ajustes espec√≠ficos para m√≥viles */
@media (max-width: 600px) {
  .iniciativa strong {
    font-size: 1.4rem;
  }

  .fase strong {
    font-size: 1.3rem;
  }

  .tarea {
    font-size: 1.2rem;
    padding: 14px 12px;
  }
}

/* M√≥viles muy peque√±os */
@media (max-width: 380px) {
  .iniciativa strong {
    font-size: 1.3rem;
  }

  .fase strong {
    font-size: 1.2rem;
  }

  .tarea {
    font-size: 1.1rem;
  }

  }


 .btn-delegar {
  background-color: #6c5ce7; /* violeta IMPULSO */
  color: white;
  padding: 8px 14px;
  border: none;
  border-radius: 8px;
  font-size: 0.9rem;
  cursor: pointer;
  margin-top: 8px;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.btn-delegar:hover {
  background-color: #5a4bd1;
  transform: translateY(-1px);
}

.btn-delegar:active {
  transform: translateY(1px);
}













</style>
</head>

<body>

<h1>üß† Mapa Mental de Maternidad</h1>

<div style="margin-bottom: 20px;">
  <label>Filtrar tareas por estado:</label>
  <select id="filtroEstado" onchange="filtrarTareas()">
    <option value="todas">Todas</option>
    <option value="pendiente">Pendientes</option>
    <option value="progreso">En progreso</option>
    <option value="completada">Completadas</option>
    <option value="retrasada">Retrasadas</option>
  </select>
</div>

<a href="{% url 'feed_comunitario' %}" class="boton-final volver">
    ‚Üê Volver al feed
  </a>


<p class="subtitulo">Una vista clara y emocional de tus cargas mentales, organizada por √°reas clave.</p>

<div class="grid-dimensiones">

  <!-- DIMENSI√ìN 1 -->
  {% for key, cat in categorias.items %}
  <div class="dimension" style="border-left-color: {{ cat.color }};">
    <h2>{{ cat.icono }} {{ cat.nombre }}</h2>

    <div class="barra-carga">
      <div class="barra-interna" style="width: {{ cat.porcentaje }}%;"></div>
    </div>
    <div class="porcentaje">{{ cat.porcentaje }}% de carga mental</div>

    <ul class="subcategorias">

  {% for ini in cat.iniciativas %}

    <!-- INICIATIVA -->
    <div class="iniciativa" onclick="toggle(this)" style="background-color: {{ cat.color }}CC;">
      <strong>{{ ini.nombre }}</strong>
      <span class="info">{{ ini.fases|length }} fases</span>
    </div>

    <!-- FASES -->
    <div class="fases oculto">
      {% for fase in ini.fases %}

        <div class="fase" onclick="toggle(this)" style="background-color: {{ cat.color }}66;">
          <strong>{{ fase.nombre }}</strong>
          <span class="info">
            {{ fase.tareas_totales }} tareas,
            {{ fase.tareas_completadas }} completadas,
            {{ fase.tareas_retrasadas }} retrasadas
          </span>
        </div>

        <!-- TAREAS -->
        <ul class="tareas oculto">
          {% for tarea in fase.tareas %}

            <li class="tarea
  {% if tarea.estado == 'completada' %}tarea-completada{% endif %}
  {% if tarea.estado == 'progreso' %}tarea-progreso{% endif %}
  {% if tarea.estado == 'pendiente' %}tarea-pendiente{% endif %}
  {% if tarea.retrasada %}tarea-retrasada{% endif %}
"
data-status="{{ tarea.estado }}"
style="background-color: {{ cat.color }}44;">

  {{ tarea.nombre }}

  {% if tarea.estado == 'completada' %}
    ‚úî
  {% elif tarea.retrasada %}
    ‚ö† retrasada
  {% endif %}

  <!-- MOSTRAR A QUI√âN EST√Å DELEGADA -->
  {% if tarea.delegado %}
    <div class="delegada-a">
      Delegada a: <strong>{{ tarea.delegado.nombre }}</strong>
    </div>
  {% endif %}

  <!-- BOT√ìN DELEGAR -->
  <form method="post" action="{% url 'delegar_tarea' %}" style="margin-top: 8px;">
      {% csrf_token %}
      <input type="hidden" name="tarea_id" value="{{ tarea.id }}">
      <button type="submit" class="btn-delegar">Delegar</button>
  </form>

</li>


          {% empty %}
            <li style="opacity:0.6;">Sin tareas a√∫n</li>
          {% endfor %}
        </ul>

      {% empty %}
        <p style="opacity:0.6;">Sin fases a√∫n</p>
      {% endfor %}
    </div>

  {% empty %}
    <p style="opacity:0.6;">Sin iniciativas a√∫n</p>
  {% endfor %}

</ul>



  </div>
{% endfor %}



</div>

<script>
function toggle(element) {
  const next = element.nextElementSibling;
  if (!next) return;
  next.classList.toggle('oculto');
}

function filtrarTareas() {
  const estado = document.getElementById('filtroEstado').value;
  const tareas = document.querySelectorAll('.tarea');

  tareas.forEach(t => {
    const st = t.dataset.status;

    if (estado === 'todas' || estado === st) {
      t.style.display = 'list-item';
    } else {
      t.style.display = 'none';
    }
  });
}
</script>


</body>
</html>
